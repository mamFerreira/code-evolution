<h1>{{title}}</h1>   
<label *ngIf="evolution && level">    
    <h2>{{evolution.name}}: {{level.order}}. {{level.title}}</h2> 
</label>
<app-alert></app-alert>
<!--Botones-->
<div *ngIf="game">
    <button type="button" class="btn btn-primary-ce" [ngClass]="{'active': lastAction === 0 }" [disabled]="game.stateGame === 0 || game.stateGame === 1" (click)="doAction(0);">
        <span class="glyphicon glyphicon-refresh"></span>
    </button>
    <button type="button" class="btn btn-primary-ce" [ngClass]="{'active': lastAction === 1}" [disabled]="game.stateGame !== 0 && game.stateGame !== 2" (click)="doAction(1);">
        <span class="glyphicon glyphicon-play"></span>
    </button>
    <button type="button" class="btn btn-primary-ce" [ngClass]="{'active': lastAction === 2 }" [disabled]="game.stateGame !== 1" (click)="doAction(2);">
        <span class="glyphicon glyphicon-pause"></span>
    </button>
    <button type="button" class="btn btn-primary-ce" *ngIf="!game.volume" (click)="doAction(5);" >
        <span class="glyphicon glyphicon-volume-off"></span>
    </button>
    <button type="button" class="btn btn-primary-ce" *ngIf="game.volume" (click)="doAction(5);">
        <span class="glyphicon glyphicon-volume-up"></span>
    </button> 
    <button type="button" class="btn btn-primary-ce">
        <span class="glyphicon glyphicon-info-sign"></span>
    </button>
    <button type="button" class="btn btn-primary-ce" [routerLink]="['/jugar/evolucion/'+evolution._id]">
        <span class="glyphicon glyphicon-log-out"></span>
    </button>    
</div>    
<!--Fin Botones-->
<!--Canvas-->
<div class="col-md-5" *ngIf="game" > 
    <div id="phaser-game" class="canvas"></div>          
</div>
<!--Fin Canvas-->
<!--Menús Información-->
<div class="col-md-2">
    <table class="table table-bordered table-ce" *ngIf="game">
        <thead>
            <tr>
                <th>Objetivos
                    <i class="fa bigicon" data-toggle="collapse" data-target=".goals" [ngClass]="{'fa-plus-square':!showGoals,'fa-minus-square':showGoals}" (click)="showGoals = !showGoals"></i>                    
                </th>
            </tr>
        </thead>
        <tbody class="collapse in goals">
            <tr *ngFor="let g of game.goals">
                <td [ngClass]="{'goal-no-check': !g[1], 'goal-check': g[1]}">{{g[0]}}</td>                  
            </tr>            
        </tbody>
    </table>
    <table class="table table-bordered table-ce" *ngIf="actions">
        <thead>
            <tr>
                <th>
                    Acciones
                    <i class="fa bigicon" data-toggle="collapse" data-target=".actions" [ngClass]="{'fa-plus-square':!showActions,'fa-minus-square':showActions}" (click)="showActions = !showActions"></i>                    
                </th>
            </tr>
        </thead>
        <tbody class="collapse actions">
            <tr *ngFor="let a of actions; let i=index">                                                
                <td>
                    <popover-content #ppAction title= "{{a.action.method}}" placement="auto left" [animation]="false" [closeOnClickOutside]="true" >
                        <p class="popover-description">{{a.action.description}}</p>
                        <pre *ngIf="a.action.example" [innerHTML]="a.action.example" class="popover-example"></pre>
                    </popover-content>
                    <a [popover]="ppAction" class="popover-botton">{{a.action.method}}</a>
                </td>
            </tr>            
        </tbody>
    </table>                
    <table class="table table-bordered table-ce" *ngIf="learnings">
        <thead>
            <tr>
                <th>
                    Aprendizaje
                    <i class="fa bigicon" data-toggle="collapse" data-target=".learnings" [ngClass]="{'fa-plus-square':!showLearnings,'fa-minus-square':showLearnings}" (click)="showLearnings = !showLearnings"></i>
                </th>
            </tr>
        </thead>
        <tbody class="collapse learnings">
            <tr *ngFor="let l of learnings">
                <td>
                    <popover-content #ppLearning title= "{{l.learning.title}}" placement="auto left" [animation]="false" [closeOnClickOutside]="true">
                        <p class="popover-description" [innerHTML]="l.learning.description"></p>
                        <pre *ngIf="l.learning.example" [innerHTML]="l.learning.example" class="popover-example"></pre>                            
                    </popover-content>
                    <a [popover]="ppLearning" class="popover-botton">{{l.learning.key}}</a>
                </td>                  
            </tr>            
        </tbody>
    </table> 
</div>
<!--Fin Menus Información-->
<!--Editor de textos-->
<div class="col-md-5">    
    <ace-editor [(text)]="code" #editor class="editor"></ace-editor>
    <p class="shell" [ngClass]="{'shell-error': game.error }" *ngIf="game" [innerHTML]="game.codeShell"></p>
</div>

<div *ngIf="game && evolution">
    <div class="backdrop" [ngClass]="{'display-none':game.stateGame!==4 && game.stateGame!==5,'display-block':game.stateGame===4 || game.stateGame===5}"></div>
    <div class="modal" tabindex="-1" role="dialog"  [ngClass]="{'display-none':game.stateGame!==4,'display-block':game.stateGame===4}">
        <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">        
            <h1 class="modal-title">¡Nivel Superado!</h1>
            </div>
            <div class="modal-body">
            <p>Has superado el nivel</p>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-default" (click)="doAction(0)" >Jugar de nuevo</button>
            <button type="button" class="btn btn-default">Siguiente</button>
            </div>
        </div>
        </div>
    </div>
    <div class="modal" tabindex="-1" role="dialog"  [ngClass]="{'display-none':game.stateGame!==5,'display-block':game.stateGame===5}">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
            <div class="modal-header">        
                <h1 class="modal-title">¡Nivel no superado!</h1>
            </div>
            <div class="modal-body">
                <p>No has superado el nivel</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" (click)="doAction(0)" >Volver a intentar</button>
                <button type="button" class="btn btn-default" [routerLink]="['/jugar/evolucion/' + evolution._id]">Cambiar nivel</button>
            </div>
            </div>
        </div>
    </div>
</div>
